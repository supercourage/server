--source include/have_s3.inc
--source include/have_sequence.inc

--echo #
--echo # Test alter table to and from s3
--echo #

create table t1 (a int, b int) engine=aria;
insert into t1 select seq,seq+10 from seq_1_to_1000;
alter table t1 engine=s3;
show create table t1;
alter table t1 comment="hello";
show create table t1;
alter table t1 engine=aria;
show create table t1;
drop table t1;


--echo #
--echo # Test changing s3 table
--echo #

create table t1 (a int, b int) engine=aria select seq,seq+10 from seq_1_to_1000;
alter table t1 engine=s3;
alter table t1 engine=s3, compression_algorithm="zlib";
show create table t1;
select * from t1 limit 5;
drop table t1;

--echo #
--echo # Test rename table
--echo #

create table t1 (a int, b int) engine=aria select seq,seq+10 from seq_1_to_10;
alter table t1 engine=s3;
rename table t1 to t2;
select count(*), sum(a), sum(b) from t2;
--error ER_NO_SUCH_TABLE
select count(*), sum(a), sum(b) from t1;
drop table t2;
